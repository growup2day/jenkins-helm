JCasC:
  configScripts:
    nonprod-jobs: |
      jobs:
        - script: |
            {{- .Files.Get "groovy-lib/pipeline-helper.groovy" | nindent 6 }}
            {{- .Files.Get "groovy-lib/multibranch-pipeline-helper.groovy" | nindent 6 }}
            {{- tpl $.Values.devProvisioningPackageJob $ | nindent 6 }}
            {{- tpl $.Values.devDeploymentPipelineJob $ | nindent 6 }}
            {{- tpl $.Values.devPipelineTestingSuite1Job $ | nindent 6 }}
            {{- tpl $.Values.devDeploymentPipelineTestingSuite1Job $ | nindent 6 }}
            {{- tpl $.Values.devPipelineTestingSuite2Job $ | nindent 6 }}
            {{- tpl $.Values.devDeploymentPipelineTestingSuite2Job $ | nindent 6 }}
            {{- tpl $.Values.devPipelineTestingSuite3Job $ | nindent 6 }}
            {{- tpl $.Values.devDeploymentPipelineTestingSuite3Job $ | nindent 6 }}
            {{- tpl $.Values.devPipelineTestingSuite4Job $ | nindent 6 }}
            {{- tpl $.Values.devDeploymentPipelineTestingSuite4Job $ | nindent 6 }}
            {{- tpl $.Values.da_test_core_development_pipeline $ | nindent 6 }}
            {{- tpl $.Values.da_test_core_master_builder $ | nindent 6 }}
            {{- tpl $.Values.udeployPipeline $ | nindent 6 }}
            
devProvisioningPackageJob: |
  bitbucketPipelineJob(
    jobName: "NZDW Provisioning Package - DEV Pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "Jenkinsfile_DEV",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    buildRetentionNumStr: "100",
    parametersNeeded: true,
    stringParams: [
      [
        name: 'branch_name', 
        desc: 'Branch name to run i.e. SKYNET/DST-1234_short_description', 
        trim: false
      ]
    ],
    authorization: true,
    jobPerms: [
      [
        name: 'anonymous',
        type: 'user',
        permissions: [
          'Job/Read'
        ]
      ],
      [
        name: 'authenticated',
        type: 'group',
        permissions: [
          'Job/Read', 
          'Job/Cancel',
          'Job/Build',
          'Run/Replay'
        ]
      ]
    ],
  )

devDeploymentPipelineJob: |
  bitbucketPipelineJob(
    jobName: "NZDW - DEV Deployment pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "vars/Jenkins-datapipeline-deploy.groovy",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    buildRetentionNumStr: "100",
    parametersNeeded: true,
    stringParams: [
      [
        name: 'version', 
        desc: '', 
      ],
      [
        name: 'Branch_name',
        desc: 'used within DEV pipeline only',
      ],
      [
        name: 'ChangeRequestID',
        desc: 'An optional field within DEV pipeline.',
        defaultValue: '2018-11-23',
      ],
      [
        name: 'TraceFlag',
        desc: 'This trace flag is passed down from the parent job so that this job can be easily traced in log files.'
      ]
    ],
    choiceParams: [
      [
        name: 'EnvironmentToken',
        desc: 'Database environment to deploy to',
        options: [
          'DEV01',
          'ITG'
        ]
      ]
    ],
    booleanParams: [
      [
        name: 'TeradataDeploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'DatastageUnixDeploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'Dml2Deploy',
        defaultValue: false,
        desc: ''
      ],
      [
        name: 'OracleDeploy',
        defaultValue: false,
        desc: ''
      ],
      [
        name: 'ControlMDeploy',
        defaultValue: false,
        desc: ''
      ]
    ],
    authorization: true,
    jobPerms: [
      [
        name: 'anonymous',
        type: 'user',
        permissions: [
          'Job/Read'
        ]
      ],
      [
        name: 'authenticated',
        type: 'group',
        permissions: [
          'Job/Read', 
          'Job/Cancel'
        ]
      ]
    ],
  )

devPipelineTestingSuite1Job: |
  bitbucketPipelineJob(
    jobName: "Testing Suite 1 - DEV Pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "Jenkinsfile_DEV",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    parametersNeeded: true,
    stringParams: [
      [
        name: 'branch_name',
        desc: 'Branch name to run i.e. SKYNET/DST-1234_short_description',
        trim: false
      ]
    ],
    authorization: true,
    buildRetentionNumStr: "10",
  )

devDeploymentPipelineTestingSuite1Job: |
  bitbucketPipelineJob(
    jobName: "Testing Suite 1 - DEV Deployment Pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "vars/Jenkins-datapipeline-deploy.groovy",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    parametersNeeded: true,
    stringParams: [
      [
        name: 'version',
        desc: '',
      ],
      [
        name: 'Branch_name',
        desc: 'Used within DEV Pipeline only.',
      ],
      [
        name: 'ChangeRequestID',
        desc: 'An optional field within DEV pipeline.',
        defaultValue: '2018-11-23',
      ],
      [
        name: 'TraceFlag',
        desc: 'This trace flag is passed down from the parent job so that this job can be easily traced in log files.'
      ]
    ],
    choiceParams: [
      [
        name: 'EnvironmentToken',
        desc: 'Database environment to deploy to.',
        options: [
          'DEV01',
          'ITG'
        ]
      ]
    ],
    booleanParams: [
      [
        name: 'TeradataDeploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'DatastageUnixDeploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'Dml2Deploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'OracleDeploy',
        defaultValue: false,
        desc: ''
      ],
      [
        name: 'ControlMDeploy',
        defaultValue: false,
        desc: ''
      ]
    ],
    authorization: true,
    buildRetentionNumStr: "10",
  )

devPipelineTestingSuite2Job: |
  bitbucketPipelineJob(
    jobName: "Testing Suite 2 - DEV Pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "Jenkinsfile_DEV",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    parametersNeeded: true,
    stringParams: [
      [
        name: 'branch_name',
        desc: 'Branch name to run i.e. SKYNET/DST-1234_short_description',
        trim: false
      ]
    ],
    authorization: true,
    buildRetentionNumStr: "10",
  )

devDeploymentPipelineTestingSuite2Job: |
  bitbucketPipelineJob(
    jobName: "Testing Suite 2 - DEV Deployment Pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "vars/Jenkins-datapipeline-deploy.groovy",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    parametersNeeded: true,
    stringParams: [
      [
        name: 'version',
        desc: '',
      ],
      [
        name: 'Branch_name',
        desc: 'Used within DEV Pipeline only.',
      ],
      [
        name: 'ChangeRequestID',
        desc: 'An optional field within DEV pipeline.',
        defaultValue: '2018-11-23',
      ],
      [
        name: 'TraceFlag',
        desc: 'This trace flag is passed down from the parent job so that this job can be easily traced in log files.'
      ]
    ],
    choiceParams: [
      [
        name: 'EnvironmentToken',
        desc: 'Database environment to deploy to.',
        options: [
          'DEV01',
          'ITG'
        ]
      ]
    ],
    booleanParams: [
      [
        name: 'TeradataDeploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'DatastageUnixDeploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'Dml2Deploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'OracleDeploy',
        defaultValue: false,
        desc: ''
      ],
      [
        name: 'ControlMDeploy',
        defaultValue: false,
        desc: ''
      ]
    ],
    authorization: true,
    buildRetentionNumStr: "10",
  )

devPipelineTestingSuite3Job: |
  bitbucketPipelineJob(
    jobName: "Testing Suite 3 - DEV Pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "Jenkinsfile_DEV",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    parametersNeeded: true,
    stringParams: [
      [
        name: 'branch_name',
        desc: 'Branch name to run i.e. SKYNET/DST-1234_short_description',
        trim: false
      ]
    ],
    authorization: true,
    buildRetentionNumStr: "10",
  )

devDeploymentPipelineTestingSuite3Job: |
  bitbucketPipelineJob(
    jobName: "Testing Suite 3 - DEV Deployment Pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "vars/Jenkins-datapipeline-deploy.groovy",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    parametersNeeded: true,
    stringParams: [
      [
        name: 'version',
        desc: '',
      ],
      [
        name: 'Branch_name',
        desc: 'Used within DEV Pipeline only.',
      ],
      [
        name: 'ChangeRequestID',
        desc: 'An optional field within DEV pipeline.',
        defaultValue: '2018-11-23',
      ],
      [
        name: 'TraceFlag',
        desc: 'This trace flag is passed down from the parent job so that this job can be easily traced in log files.'
      ]
    ],
    choiceParams: [
      [
        name: 'EnvironmentToken',
        desc: 'Database environment to deploy to.',
        options: [
          'DEV01',
          'ITG'
        ]
      ]
    ],
    booleanParams: [
      [
        name: 'TeradataDeploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'DatastageUnixDeploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'Dml2Deploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'OracleDeploy',
        defaultValue: false,
        desc: ''
      ],
      [
        name: 'ControlMDeploy',
        defaultValue: false,
        desc: ''
      ]
    ],
    authorization: true,
    buildRetentionNumStr: "10",
  )

devPipelineTestingSuite4Job: |
  bitbucketPipelineJob(
    jobName: "Testing Suite 4 - DEV Pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "Jenkinsfile_DEV",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    parametersNeeded: true,
    stringParams: [
      [
        name: 'branch_name',
        desc: 'Branch name to run i.e. SKYNET/DST-1234_short_description',
        trim: false
      ]
    ],
    authorization: true,
    buildRetentionNumStr: "10",
  )

devDeploymentPipelineTestingSuite4Job: |
  bitbucketPipelineJob(
    jobName: "Testing Suite 4 - DEV Deployment Pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "vars/Jenkins-datapipeline-deploy.groovy",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    parametersNeeded: true,
    stringParams: [
      [
        name: 'version',
        desc: '',
      ],
      [
        name: 'Branch_name',
        desc: 'Used within DEV Pipeline only.',
      ],
      [
        name: 'ChangeRequestID',
        desc: 'An optional field within DEV pipeline.',
        defaultValue: '2018-11-23',
      ],
      [
        name: 'TraceFlag',
        desc: 'This trace flag is passed down from the parent job so that this job can be easily traced in log files.'
      ]
    ],
    choiceParams: [
      [
        name: 'EnvironmentToken',
        desc: 'Database environment to deploy to.',
        options: [
          'DEV01',
          'ITG'
        ]
      ]
    ],
    booleanParams: [
      [
        name: 'TeradataDeploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'DatastageUnixDeploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'Dml2Deploy',
        defaultValue: true,
        desc: ''
      ],
      [
        name: 'OracleDeploy',
        defaultValue: false,
        desc: ''
      ],
      [
        name: 'ControlMDeploy',
        defaultValue: false,
        desc: ''
      ]
    ],
    authorization: true,
    buildRetentionNumStr: "10",
  )

da_test_core_development_pipeline: |
  bitbucketMultibranchPipelineJob(
    [
      jobName: 'DA_TEST_CORE_DEVELOPMENT_PIPELINE',
      project: 'DN',
      repo: 'da-test-core',
      credentialsId: 'Bitbucket_Service_Account',

      // optional parameters
      displayName: 'DA_TEST_CORE_DEVELOPMENT_PIPELINE',
      serverUrl: 'https://bitbucket.nz.service.anz',
      scriptPath: 'Jenkinsfile.groovy',
      branchDiscoveryStrategyId: 1,
      discoverPullRequests: true,
      branchRegex: '.*',
      periodicScanInterval: '1m',
      discardOldItemsDays: 14,
      discardOldItemsNum: 15,
      noTriggerBranchProperty: false,
      triggerBuildOnPush: false,
    ]
  )

da_test_core_master_builder: |
  bitbucketPipelineJob(
    jobName: "DA_TEST_CORE_MASTER_BUILDER",
    gitUrl: "https://bitbucket.nz.service.anz/scm/dn/da-test-core.git",
    credentialsId: "Bitbucket_Service_Account",
    branch: "*/master",
    disableConcurBuilds: false,
    description: "",
    triggerBuildOnPush: false,
    scriptPath: "MasterBuilder.groovy",
    lightweight: true,
    jiraProject: true,
    jiraSite: "https://jira.nz.service.anz/",
    cronSpec: "H 5 * * 5",
    pollSCMSpec: null,
    authorization: true,
    blocksInheritance: false,
    jobPerms: [
      [
        name: 'authenticated',
        type: 'group',
        permissions: [
          'Job/Read',
          'Job/Cancel',
          'Job/Build',
          'Run/Replay'
        ]
      ],
      [
        name: 'anonymous',
        type: 'user',
        permissions: [
          'Job/Read'
        ]
      ]
    ],
  )

udeployPipeline: |
  bitbucketPipelineJob(
    jobName: "Alternative Deployment Pipeline",
    gitUrl: "https://bitbucket.nz.service.anz:443/scm/dn/nzdw_build_utility.git",
    credentialsId: "bitBucketUsernamePasswordCredentials",
    branch: "master",
    scriptPath: "udeploy/globaltest/Jenkinsfile",
    triggerBuildOnPush: false,
    disableConcurBuilds: false,
    pollSCMSpec: false,
    buildRetentionNumStr: "100",
    parametersNeeded: true,
    authorization: true,
    jobPerms: [
      [
        name: 'authenticated',
        type: 'group',
        permissions: [
          'Job/Read', 
          'Job/Cancel',
          'Job/Build',
          'Run/Replay'
        ]
      ]
    ],
  )